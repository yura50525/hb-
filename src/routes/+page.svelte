<script>
	import JSConfetti from 'js-confetti';
	import { onMount } from 'svelte';
	import AnimText from '$lib/AnimText.svelte';
	import { fade } from 'svelte/transition';

	let text = '–ö—É –∫—É)';
	let n = 0;
	let repeat_button = false;

	function animate({ mes, delay, _confetti, _confettiNumber, _confettiRadius, rep }) {
		if (mes) {
			n = n + delay;
			setTimeout(() => {
				text = mes;
			}, n);
		}

		if (_confetti) {
			setTimeout(() => {
				const jsConfetti = new JSConfetti();
				jsConfetti.addConfetti({
					confettiRadius: _confettiRadius,
					confettiNumber: _confettiNumber ? _confettiNumber : 250
				});
			}, n);
			n = n + delay;
		}
		if (rep) {
			n = n + delay;
			setTimeout(() => {
				repeat_button = rep;
			}, n);
		}
	}

	onMount(() => {
		animate({ mes: '–í—ñ—Ç–∞—é —Ç–µ–±–µ –∑ –¥–Ω–µ–º –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è üéâ', delay: 3000, rep: false });
		animate({ mes: '–ë–∞–∂–∞—é –≤—Å—å–æ–≥–æ –Ω–∞–π–∫—Ä–∞—â–æ–≥–æ', delay: 6000 });
		animate({ mes: '–©–æ–± —Ç–∏ –∑–∞–≤–∂–¥–∏ –±—É–ª–∞ —É—Å–º—ñ—Ö–Ω–µ–Ω–∞ üòä', delay: 5000 });
		animate({ mes: '–©–æ–± –≤—Å—ñ —Ç–≤–æ—ó –ø–ª–∞–Ω–∏ –Ω–∞ –º–∞–π–±—É—Ç–Ω—î –∑–¥—ñ–π—Å–Ω–∏–ª–∏—Å—èüåü', delay: 5000 });
		animate({ mes: '–©–æ–± –¥—Ä—É–∑—ñ —Ç–∞ —Ä—ñ–¥–Ω—ñ –∑–∞–≤–∂–¥–∏ –±—É–ª–∏ –ø–æ—Ä—É—á ü´Ç', delay: 6000 });
		animate({ mes: '–©–æ–± –≤—á–∏–ª–∞—Å—å —Ç—ñ–ª—å–∫–∏ –Ω–∞ –≤–∏—Å–æ–∫—ñ –±–∞–ª–∏ üë©‚Äçüéì', delay: 5000 });
		animate({ mes: '–©–æ–± –∫–æ—Ö–∞–Ω–∞ –ª—é–¥–∏–Ω–∞ –∑–∞–≤–∂–¥–∏ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–ª–∞ —Ç–µ–±–µ –≤ —É—Å—å–æ–º—Éüë©‚Äç‚ù§Ô∏è‚Äçüë®', delay: 6000 });
		animate({
			mes: '–©–æ–± –≤ –∂–∏—Ç—Ç—ñ —Ç–∏ —Ä–æ–±–∏–ª–∞ —Ç–µ —â–æ —Ö–æ—á–µ—à üòã —ñ —Ü–µ –ø—Ä–∏–Ω–æ—Å–∏–ª–æ —á–∏–º–∞–ª–∏–π –ø—Ä–∏–±—É—Ç–æ–∫ üí∏',
			delay: 7000
		});
		animate({
			mes: '–ê –Ω–∞–π–≥–æ–ª–æ–≤–Ω—ñ—à–µ —â–æ–± —Ç–∏ –±—É–ª–∞ –∑–¥–æ—Ä–æ–≤–∞ üòá —Ç–∞ –∑–∞–ª–∏—à–∞–ª–∞—Å—è —Ç–∞–∫–æ—é —è–∫–æ—é —Ç–∏ —î',
			delay: 8500
		});
		animate({ mes: '–ö—Ä–∞—Å–∏–≤–æ—é üëë', delay: 7000 });
		animate({ mes: '–í–µ—Å–µ–ª–æ—é üòÑ', delay: 3000 });
		animate({ mes: '–ö–º—ñ—Ç–ª–∏–≤–æ—é ü§ì', delay: 3000 });
		animate({ mes: '–°—Ç–∏–ª—å–Ω–æ—é üíÖ', delay: 3000 });
		animate({ mes: '–¢–∞ –≤–º—ñ—é—á—É—é –∑–∞–≤–∂–¥–∏ –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ ü´∂', delay: 3000 });
		animate({ mes: "–ü–∞–º'—è—Ç–∞–π —Ç–∏ –Ω–∞–π–∫—Ä–∞—â–∞ —ñ –≤ —Ç–µ–±–µ –≤—Å–µ –≤–∏–π–¥–µ ü§ç", delay: 5000 });
		animate({ mes: '–ó –î–Ω–µ–º –Ω–∞—Ä–∞–æ–¥–∂–µ–Ω–Ω—è ü•≥', delay: 7000, _confetti: true, _confettiRadius: 5 });
		animate({ rep: true, delay: 3000 });
	});
</script>

<svelte:head>
	<title>Congrats</title>
</svelte:head>

<section class="flex my-auto flex-col justify-center items-center gap-72">
	<AnimText {text} font_size={'200rem'} />

	{#if repeat_button}
		<button
			in:fade={{ duration: 500 }}
			onClick="window.location.reload()"
			class=" text-black bg-white rounded-lg flex items-center justify-center w-auto h-[40px] "
			><span class="symbol py-1 px-2.5 font-thin text-[1.2rem]">re-play</span></button
		>
	{/if}
</section>

<style scoped>
	button {
		filter: drop-shadow(0px 0px 5px#fff);
		animation: pulsee 2s infinite;
	}

	.symbol {
		filter: drop-shadow(0px 0px 10px #000);
	}

	@keyframes pulsee {
		0% {
			filter: drop-shadow(0px 0px 10px #fff);
		}
		50% {
			filter: drop-shadow(0px 0px 8px #fff);
		}
		100% {
			filter: drop-shadow(0px 0px 10px #fff);
		}
	}
</style>
